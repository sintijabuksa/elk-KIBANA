import requests
from requests.auth import HTTPBasicAuth
import credentials
import json

session = requests.Session()
session.auth = HTTPBasicAuth(credentials.username, credentials.password)
kibana_url = "https://observability-34c3a7.kb.westeurope.azure.elastic-cloud.com:9243"
headers = {"kbn-xsrf": "true", "Content-Type": "application/json"}

#define properties for the index pattern 
index_pattern = {"index_pattern": {"id": "001", "version": "1", "title": "postgredb-logs*", "sourceFilters": [], "fields": {}, "typeMeta": {}, "fieldFormats": {}, "runtimeFieldMap": {}, "fieldAttrs": {}, "allowNoIndex": "false", "name": "postgredb-logs*", "namespaces": ["azure"]}}

r = session.post(kibana_url + "/api/index_patterns/index_pattern", headers=headers, json=index_pattern)
print(r.json())
